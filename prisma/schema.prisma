// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  // NOTE: When using mysql or sqlserver, uncomment the @db.Text annotations in model Account below
  // Further reading:
  // https://next-auth.js.org/adapters/prisma#create-the-prisma-schema
  // https://www.prisma.io/docs/reference/api-reference/prisma-schema-reference#string
  url      = env("DATABASE_URL")
}

model Anime {
  id             Int     @id
  title          String
  description    String? @db.Text
  image          String?
  type           String?
  episodes       String?
  status         String?
  premiered      String?
  releasedSeason String?
  releasedYear   Float?
  source         String?
  genres         String?
  themes         String?
  studios        String?
  producers      String?
  demographic    String?
  duration       String?
  rating         String?
  score          Float?
  ranked         String?
  popularity     String?
  members        String?
  favorites      String?
  characters     Json?
  sourceUrl      String?
}

// Necessary for Next auth
model Account {
  id                       String  @id @default(cuid())
  userId                   String
  type                     String
  provider                 String
  providerAccountId        String
  refresh_token            String? // @db.Text
  access_token             String? // @db.Text
  expires_at               Int?
  token_type               String?
  scope                    String?
  id_token                 String? // @db.Text
  session_state            String?
  user                     User    @relation(fields: [userId], references: [id], onDelete: Cascade)
  refresh_token_expires_in Int?

  @@unique([provider, providerAccountId])
}

model Carousel {
  id            Int    @id @default(autoincrement())
  alt           String
  mobileSource  String // Portrait image for mobile
  desktopSource String // Landscape image for desktop
  order         Int    @default(0)
}

model Committee {
  id     Int     @id @default(autoincrement())
  role   String
  source String?
  name   String
}

model Image {
  id              Int      @id @default(autoincrement())
  source          String
  thumbnailSource String
  alt             String
  category        String
  year            Int
  createdAt       DateTime @default(now())
}

model Event {
  id                 Int      @id @default(autoincrement())
  title              String
  description        String
  location           String
  date               DateTime
  color              String
  is_regular_session Boolean
  session_count      Int?
}

model Manga {
  id          Int     @id @default(autoincrement())
  title       String
  author      String
  volume      Int
  borrowed_by String?
  source      String
  genres      Genre[]
}

model Genre {
  id     Int         @id @default(autoincrement())
  name   String      @unique
  cards  AnimeCard[]
  mangas Manga[]
}

model AnimeCard {
  id             Int     @id @default(autoincrement())
  title          String
  episode        String
  source         String
  mal_link       String
  total_episodes Int
  show_type      String
  studio         String
  genres         Genre[]
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       String
  expires      DateTime
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model User {
  id            String    @id @default(cuid())
  name          String?
  email         String?   @unique
  emailVerified DateTime?
  image         String?
  wins          Int       @default(0)
  lastWonAt     DateTime?
  totalTries    Int       @default(0)
  role          String    @default("user")
  accounts      Account[]
  sessions      Session[]
  dailyGuesses  Int       @default(0)
  lastGuessAt   DateTime?
}

model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
}
